#include <stdio.h>
#include "envelopes.h"

uint16_t interpolate_env(uint32_t rel_pos, uint32_t length_decay, const uint16_t* lookup_table){
    uint32_t pos_ = (rel_pos << 15) / length_decay << 8;
    uint16_t int_pos = pos_ >> 15;
    uint16_t a = lookup_table[int_pos];
    uint16_t b = lookup_table[int_pos + 1];
    uint16_t output = a + ((b - a) * (pos_ & ((1 << 15) - 1)) >> 15);
    return output;
}

void interpolate_env_alt(int32_t* sample, uint32_t rel_pos, uint32_t length_decay, const uint16_t* lookup_table){
    uint32_t pos_ = ((rel_pos << 15) / length_decay) << 8;
    uint16_t int_pos = pos_ >> 15;
    uint16_t a = lookup_table[int_pos];
    uint16_t b = lookup_table[int_pos + 1];
    uint16_t output = a + ((b - a) * (pos_ & ((1 << 15) - 1)) >> 15);
    *sample = (*sample * output) >> 16;
}

const uint16_t lambda[] = {
    12985, 12495, 12041, 11618,
    11224, 10856, 10511, 10188,
    9883, 9597, 9326, 9071,
    8829, 8599, 8381, 8174,
    7977, 7789, 7610, 7439,
    7275, 7119, 6969, 6825,
    6687, 6555, 6427, 6305,
    6187, 6073, 5963, 5858,
    5756, 5657, 5562, 5470,
    5381, 5295, 5211, 5130,
    5052, 4976, 4902, 4830,
    4760, 4693, 4627, 4563,
    4501, 4440, 4381, 4324,
    4268, 4214, 4160, 4109,
    4058, 4009, 3961, 3914,
    3868, 3823, 3779, 3736,
    3694, 3653, 3613, 3574,
    3536, 3498, 3461, 3425,
    3390, 3356, 3322, 3289,
    3256, 3224, 3193, 3162,
    3132, 3103, 3074, 3045,
    3017, 2990, 2963, 2936,
    2910, 2885, 2860, 2835,
    2811, 2787, 2763, 2740,
    2718, 2695, 2673, 2652,
    2631, 2610, 2589, 2569,
    2549, 2529, 2510, 2491,
    2472, 2453, 2435, 2417,
    2400, 2382, 2365, 2348,
    2331, 2315, 2298, 2282,
    2267, 2251, 2236, 2220,
    2205, 2191, 2176, 2162,
    2147, 2133, 2120, 2106,
    2092, 2079, 2066, 2053,
    2040, 2027, 2015, 2002,
    1990, 1978, 1966, 1954,
    1943, 1931, 1920, 1909,
    1897, 1886, 1876, 1865,
    1854, 1844, 1833, 1823,
    1813, 1803, 1793, 1783,
    1773, 1763, 1754, 1745,
    1735, 1726, 1717, 1708,
    1699, 1690, 1681, 1672,
    1664, 1655, 1647, 1639,
    1630, 1622, 1614, 1606,
    1598, 1590, 1582, 1575,
    1567, 1559, 1552, 1545,
    1537, 1530, 1523, 1515,
    1508, 1501, 1494, 1487,
    1481, 1474, 1467, 1460,
    1454, 1447, 1441, 1434,
    1428, 1422, 1415, 1409,
    1403, 1397, 1391, 1385,
    1379, 1373, 1367, 1361,
    1355, 1350, 1344, 1338,
    1333, 1327, 1322, 1316,
    1311, 1306, 1300, 1295,
    1290, 1285, 1279, 1274,
    1269, 1264, 1259, 1254,
    1249, 1244, 1240, 1235,
    1230, 1225, 1220, 1216,
    1211, 1207, 1202, 1197,
    1193, 1188, 1184, 1180,
    1175, 1171, 1167, 1162
};

const uint16_t log_env[] = {
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65535, 65535, 65535,
    65535, 65534, 65534, 65534,
    65533, 65532, 65531, 65529,
    65527, 65523, 65518, 65511,
    65501, 65487, 65467, 65440,
    65401, 65347, 65272, 65168,
    65022, 64819, 64538, 64149,
    63610, 62865, 61836, 60418,
    58465, 55780, 52093, 47036,
    40108, 30629, 17677, 0, 
    0,
};

const uint16_t exp_env[] = {
    65535, 62568, 59736, 57032,
    54450, 51986, 49632, 47386,
    45241, 43193, 41238, 39371,
    37589, 35887, 34263, 32712,
    31231, 29817, 28467, 27179,
    25948, 24774, 23652, 22582,
    21560, 20584, 19652, 18762,
    17913, 17102, 16328, 15589,
    14883, 14209, 13566, 12952,
    12366, 11806, 11272, 10761,
    10274, 9809, 9365, 8941,
    8536, 8150, 7781, 7429,
    7093, 6772, 6465, 6172,
    5893, 5626, 5372, 5128,
    4896, 4675, 4463, 4261,
    4068, 3884, 3708, 3540,
    3380, 3227, 3081, 2941,
    2808, 2681, 2560, 2444,
    2333, 2228, 2127, 2031,
    1939, 1851, 1767, 1687,
    1611, 1538, 1468, 1402,
    1338, 1278, 1220, 1165,
    1112, 1062, 1014, 968,
    924, 882, 842, 804,
    768, 733, 700, 668,
    638, 609, 581, 555,
    530, 506, 483, 461,
    440, 420, 401, 383,
    366, 349, 333, 318,
    304, 290, 277, 264,
    253, 241, 230, 220,
    210, 200, 191, 183,
    174, 166, 159, 152,
    145, 138, 132, 126,
    120, 115, 110, 105,
    100, 95, 91, 87,
    83, 79, 76, 72,
    69, 66, 63, 60,
    57, 55, 52, 50,
    48, 45, 43, 41,
    40, 38, 36, 34,
    33, 31, 30, 29,
    27, 26, 25, 24,
    23, 22, 21, 20,
    19, 18, 17, 16,
    16, 15, 14, 14,
    13, 12, 12, 11,
    11, 10, 10, 9,
    9, 9, 8, 8,
    7, 7, 7, 7,
    6, 6, 6, 5,
    5, 5, 5, 4,
    4, 4, 4, 4,
    4, 3, 3, 3,
    3, 3, 3, 3,
    2, 2, 2, 2,
    2, 2, 2, 2,
    2, 2, 2, 1,
    1, 1, 1, 1,
    1, 1, 1, 1,
    1, 1, 1, 1,
    1, 1, 1, 1,
    1, 1, 1, 1,
    1, 1, 1, 0,
    0
};

const int16_t cosine[] = {
   32767,  32766,  32764,  32761,
   32757,  32751,  32744,  32736,
   32727,  32717,  32705,  32692,
   32678,  32662,  32646,  32628,
   32609,  32588,  32567,  32544,
   32520,  32495,  32468,  32441,
   32412,  32382,  32350,  32318,
   32284,  32249,  32213,  32176,
   32137,  32097,  32056,  32014,
   31970,  31926,  31880,  31833,
   31785,  31735,  31684,  31633,
   31580,  31525,  31470,  31413,
   31356,  31297,  31236,  31175,
   31113,  31049,  30984,  30918,
   30851,  30783,  30713,  30643,
   30571,  30498,  30424,  30349,
   30272,  30195,  30116,  30036,
   29955,  29873,  29790,  29706,
   29621,  29534,  29446,  29358,
   29268,  29177,  29085,  28992,
   28897,  28802,  28706,  28608,
   28510,  28410,  28309,  28208,
   28105,  28001,  27896,  27790,
   27683,  27575,  27466,  27355,
   27244,  27132,  27019,  26905,
   26789,  26673,  26556,  26437,
   26318,  26198,  26077,  25954,
   25831,  25707,  25582,  25456,
   25329,  25201,  25072,  24942,
   24811,  24679,  24546,  24413,
   24278,  24143,  24006,  23869,
   23731,  23592,  23452,  23311,
   23169,  23027,  22883,  22739,
   22594,  22448,  22301,  22153,
   22004,  21855,  21705,  21554,
   21402,  21249,  21096,  20942,
   20787,  20631,  20474,  20317,
   20159,  20000,  19840,  19680,
   19519,  19357,  19194,  19031,
   18867,  18702,  18537,  18371,
   18204,  18036,  17868,  17699,
   17530,  17360,  17189,  17017,
   16845,  16672,  16499,  16325,
   16150,  15975,  15799,  15623,
   15446,  15268,  15090,  14911,
   14732,  14552,  14372,  14191,
   14009,  13827,  13645,  13462,
   13278,  13094,  12909,  12724,
   12539,  12353,  12166,  11980,
   11792,  11604,  11416,  11227,
   11038,  10849,  10659,  10469,
   10278,  10087,   9895,   9703,
    9511,   9319,   9126,   8932,
    8739,   8545,   8351,   8156,
    7961,   7766,   7571,   7375,
    7179,   6982,   6786,   6589,
    6392,   6195,   5997,   5799,
    5601,   5403,   5205,   5006,
    4807,   4608,   4409,   4210,
    4011,   3811,   3611,   3411,
    3211,   3011,   2811,   2610,
    2410,   2209,   2009,   1808,
    1607,   1406,   1206,   1005,
     804,    603,    402,    201,
       0,   -201,   -402,   -603,
    -804,  -1005,  -1206,  -1406,
   -1607,  -1808,  -2009,  -2209,
   -2410,  -2610,  -2811,  -3011,
   -3211,  -3411,  -3611,  -3811,
   -4011,  -4210,  -4409,  -4608,
   -4807,  -5006,  -5205,  -5403,
   -5601,  -5799,  -5997,  -6195,
   -6392,  -6589,  -6786,  -6982,
   -7179,  -7375,  -7571,  -7766,
   -7961,  -8156,  -8351,  -8545,
   -8739,  -8932,  -9126,  -9319,
   -9511,  -9703,  -9895, -10087,
  -10278, -10469, -10659, -10849,
  -11038, -11227, -11416, -11604,
  -11792, -11980, -12166, -12353,
  -12539, -12724, -12909, -13094,
  -13278, -13462, -13645, -13827,
  -14009, -14191, -14372, -14552,
  -14732, -14911, -15090, -15268,
  -15446, -15623, -15799, -15975,
  -16150, -16325, -16499, -16672,
  -16845, -17017, -17189, -17360,
  -17530, -17699, -17868, -18036,
  -18204, -18371, -18537, -18702,
  -18867, -19031, -19194, -19357,
  -19519, -19680, -19840, -20000,
  -20159, -20317, -20474, -20631,
  -20787, -20942, -21096, -21249,
  -21402, -21554, -21705, -21855,
  -22004, -22153, -22301, -22448,
  -22594, -22739, -22883, -23027,
  -23169, -23311, -23452, -23592,
  -23731, -23869, -24006, -24143,
  -24278, -24413, -24546, -24679,
  -24811, -24942, -25072, -25201,
  -25329, -25456, -25582, -25707,
  -25831, -25954, -26077, -26198,
  -26318, -26437, -26556, -26673,
  -26789, -26905, -27019, -27132,
  -27244, -27355, -27466, -27575,
  -27683, -27790, -27896, -28001,
  -28105, -28208, -28309, -28410,
  -28510, -28608, -28706, -28802,
  -28897, -28992, -29085, -29177,
  -29268, -29358, -29446, -29534,
  -29621, -29706, -29790, -29873,
  -29955, -30036, -30116, -30195,
  -30272, -30349, -30424, -30498,
  -30571, -30643, -30713, -30783,
  -30851, -30918, -30984, -31049,
  -31113, -31175, -31236, -31297,
  -31356, -31413, -31470, -31525,
  -31580, -31633, -31684, -31735,
  -31785, -31833, -31880, -31926,
  -31970, -32014, -32056, -32097,
  -32137, -32176, -32213, -32249,
  -32284, -32318, -32350, -32382,
  -32412, -32441, -32468, -32495,
  -32520, -32544, -32567, -32588,
  -32609, -32628, -32646, -32662,
  -32678, -32692, -32705, -32717,
  -32727, -32736, -32744, -32751,
  -32757, -32761, -32764, -32766,
  -32767, -32766, -32764, -32761,
  -32757, -32751, -32744, -32736,
  -32727, -32717, -32705, -32692,
  -32678, -32662, -32646, -32628,
  -32609, -32588, -32567, -32544,
  -32520, -32495, -32468, -32441,
  -32412, -32382, -32350, -32318,
  -32284, -32249, -32213, -32176,
  -32137, -32097, -32056, -32014,
  -31970, -31926, -31880, -31833,
  -31785, -31735, -31684, -31633,
  -31580, -31525, -31470, -31413,
  -31356, -31297, -31236, -31175,
  -31113, -31049, -30984, -30918,
  -30851, -30783, -30713, -30643,
  -30571, -30498, -30424, -30349,
  -30272, -30195, -30116, -30036,
  -29955, -29873, -29790, -29706,
  -29621, -29534, -29446, -29358,
  -29268, -29177, -29085, -28992,
  -28897, -28802, -28706, -28608,
  -28510, -28410, -28309, -28208,
  -28105, -28001, -27896, -27790,
  -27683, -27575, -27466, -27355,
  -27244, -27132, -27019, -26905,
  -26789, -26673, -26556, -26437,
  -26318, -26198, -26077, -25954,
  -25831, -25707, -25582, -25456,
  -25329, -25201, -25072, -24942,
  -24811, -24679, -24546, -24413,
  -24278, -24143, -24006, -23869,
  -23731, -23592, -23452, -23311,
  -23169, -23027, -22883, -22739,
  -22594, -22448, -22301, -22153,
  -22004, -21855, -21705, -21554,
  -21402, -21249, -21096, -20942,
  -20787, -20631, -20474, -20317,
  -20159, -20000, -19840, -19680,
  -19519, -19357, -19194, -19031,
  -18867, -18702, -18537, -18371,
  -18204, -18036, -17868, -17699,
  -17530, -17360, -17189, -17017,
  -16845, -16672, -16499, -16325,
  -16150, -15975, -15799, -15623,
  -15446, -15268, -15090, -14911,
  -14732, -14552, -14372, -14191,
  -14009, -13827, -13645, -13462,
  -13278, -13094, -12909, -12724,
  -12539, -12353, -12166, -11980,
  -11792, -11604, -11416, -11227,
  -11038, -10849, -10659, -10469,
  -10278, -10087,  -9895,  -9703,
   -9511,  -9319,  -9126,  -8932,
   -8739,  -8545,  -8351,  -8156,
   -7961,  -7766,  -7571,  -7375,
   -7179,  -6982,  -6786,  -6589,
   -6392,  -6195,  -5997,  -5799,
   -5601,  -5403,  -5205,  -5006,
   -4807,  -4608,  -4409,  -4210,
   -4011,  -3811,  -3611,  -3411,
   -3211,  -3011,  -2811,  -2610,
   -2410,  -2209,  -2009,  -1808,
   -1607,  -1406,  -1206,  -1005,
    -804,   -603,   -402,   -201,
       0,    201,    402,    603,
     804,   1005,   1206,   1406,
    1607,   1808,   2009,   2209,
    2410,   2610,   2811,   3011,
    3211,   3411,   3611,   3811,
    4011,   4210,   4409,   4608,
    4807,   5006,   5205,   5403,
    5601,   5799,   5997,   6195,
    6392,   6589,   6786,   6982,
    7179,   7375,   7571,   7766,
    7961,   8156,   8351,   8545,
    8739,   8932,   9126,   9319,
    9511,   9703,   9895,  10087,
   10278,  10469,  10659,  10849,
   11038,  11227,  11416,  11604,
   11792,  11980,  12166,  12353,
   12539,  12724,  12909,  13094,
   13278,  13462,  13645,  13827,
   14009,  14191,  14372,  14552,
   14732,  14911,  15090,  15268,
   15446,  15623,  15799,  15975,
   16150,  16325,  16499,  16672,
   16845,  17017,  17189,  17360,
   17530,  17699,  17868,  18036,
   18204,  18371,  18537,  18702,
   18867,  19031,  19194,  19357,
   19519,  19680,  19840,  20000,
   20159,  20317,  20474,  20631,
   20787,  20942,  21096,  21249,
   21402,  21554,  21705,  21855,
   22004,  22153,  22301,  22448,
   22594,  22739,  22883,  23027,
   23169,  23311,  23452,  23592,
   23731,  23869,  24006,  24143,
   24278,  24413,  24546,  24679,
   24811,  24942,  25072,  25201,
   25329,  25456,  25582,  25707,
   25831,  25954,  26077,  26198,
   26318,  26437,  26556,  26673,
   26789,  26905,  27019,  27132,
   27244,  27355,  27466,  27575,
   27683,  27790,  27896,  28001,
   28105,  28208,  28309,  28410,
   28510,  28608,  28706,  28802,
   28897,  28992,  29085,  29177,
   29268,  29358,  29446,  29534,
   29621,  29706,  29790,  29873,
   29955,  30036,  30116,  30195,
   30272,  30349,  30424,  30498,
   30571,  30643,  30713,  30783,
   30851,  30918,  30984,  31049,
   31113,  31175,  31236,  31297,
   31356,  31413,  31470,  31525,
   31580,  31633,  31684,  31735,
   31785,  31833,  31880,  31926,
   31970,  32014,  32056,  32097,
   32137,  32176,  32213,  32249,
   32284,  32318,  32350,  32382,
   32412,  32441,  32468,  32495,
   32520,  32544,  32567,  32588,
   32609,  32628,  32646,  32662,
   32678,  32692,  32705,  32717,
   32727,  32736,  32744,  32751,
   32757,  32761,  32764,  32766
};

const int16_t sine[] = {
       0,    201,    402,    603,
     804,   1005,   1206,   1406,
    1607,   1808,   2009,   2209,
    2410,   2610,   2811,   3011,
    3211,   3411,   3611,   3811,
    4011,   4210,   4409,   4608,
    4807,   5006,   5205,   5403,
    5601,   5799,   5997,   6195,
    6392,   6589,   6786,   6982,
    7179,   7375,   7571,   7766,
    7961,   8156,   8351,   8545,
    8739,   8932,   9126,   9319,
    9511,   9703,   9895,  10087,
   10278,  10469,  10659,  10849,
   11038,  11227,  11416,  11604,
   11792,  11980,  12166,  12353,
   12539,  12724,  12909,  13094,
   13278,  13462,  13645,  13827,
   14009,  14191,  14372,  14552,
   14732,  14911,  15090,  15268,
   15446,  15623,  15799,  15975,
   16150,  16325,  16499,  16672,
   16845,  17017,  17189,  17360,
   17530,  17699,  17868,  18036,
   18204,  18371,  18537,  18702,
   18867,  19031,  19194,  19357,
   19519,  19680,  19840,  20000,
   20159,  20317,  20474,  20631,
   20787,  20942,  21096,  21249,
   21402,  21554,  21705,  21855,
   22004,  22153,  22301,  22448,
   22594,  22739,  22883,  23027,
   23169,  23311,  23452,  23592,
   23731,  23869,  24006,  24143,
   24278,  24413,  24546,  24679,
   24811,  24942,  25072,  25201,
   25329,  25456,  25582,  25707,
   25831,  25954,  26077,  26198,
   26318,  26437,  26556,  26673,
   26789,  26905,  27019,  27132,
   27244,  27355,  27466,  27575,
   27683,  27790,  27896,  28001,
   28105,  28208,  28309,  28410,
   28510,  28608,  28706,  28802,
   28897,  28992,  29085,  29177,
   29268,  29358,  29446,  29534,
   29621,  29706,  29790,  29873,
   29955,  30036,  30116,  30195,
   30272,  30349,  30424,  30498,
   30571,  30643,  30713,  30783,
   30851,  30918,  30984,  31049,
   31113,  31175,  31236,  31297,
   31356,  31413,  31470,  31525,
   31580,  31633,  31684,  31735,
   31785,  31833,  31880,  31926,
   31970,  32014,  32056,  32097,
   32137,  32176,  32213,  32249,
   32284,  32318,  32350,  32382,
   32412,  32441,  32468,  32495,
   32520,  32544,  32567,  32588,
   32609,  32628,  32646,  32662,
   32678,  32692,  32705,  32717,
   32727,  32736,  32744,  32751,
   32757,  32761,  32764,  32766,
   32767,  32766,  32764,  32761,
   32757,  32751,  32744,  32736,
   32727,  32717,  32705,  32692,
   32678,  32662,  32646,  32628,
   32609,  32588,  32567,  32544,
   32520,  32495,  32468,  32441,
   32412,  32382,  32350,  32318,
   32284,  32249,  32213,  32176,
   32137,  32097,  32056,  32014,
   31970,  31926,  31880,  31833,
   31785,  31735,  31684,  31633,
   31580,  31525,  31470,  31413,
   31356,  31297,  31236,  31175,
   31113,  31049,  30984,  30918,
   30851,  30783,  30713,  30643,
   30571,  30498,  30424,  30349,
   30272,  30195,  30116,  30036,
   29955,  29873,  29790,  29706,
   29621,  29534,  29446,  29358,
   29268,  29177,  29085,  28992,
   28897,  28802,  28706,  28608,
   28510,  28410,  28309,  28208,
   28105,  28001,  27896,  27790,
   27683,  27575,  27466,  27355,
   27244,  27132,  27019,  26905,
   26789,  26673,  26556,  26437,
   26318,  26198,  26077,  25954,
   25831,  25707,  25582,  25456,
   25329,  25201,  25072,  24942,
   24811,  24679,  24546,  24413,
   24278,  24143,  24006,  23869,
   23731,  23592,  23452,  23311,
   23169,  23027,  22883,  22739,
   22594,  22448,  22301,  22153,
   22004,  21855,  21705,  21554,
   21402,  21249,  21096,  20942,
   20787,  20631,  20474,  20317,
   20159,  20000,  19840,  19680,
   19519,  19357,  19194,  19031,
   18867,  18702,  18537,  18371,
   18204,  18036,  17868,  17699,
   17530,  17360,  17189,  17017,
   16845,  16672,  16499,  16325,
   16150,  15975,  15799,  15623,
   15446,  15268,  15090,  14911,
   14732,  14552,  14372,  14191,
   14009,  13827,  13645,  13462,
   13278,  13094,  12909,  12724,
   12539,  12353,  12166,  11980,
   11792,  11604,  11416,  11227,
   11038,  10849,  10659,  10469,
   10278,  10087,   9895,   9703,
    9511,   9319,   9126,   8932,
    8739,   8545,   8351,   8156,
    7961,   7766,   7571,   7375,
    7179,   6982,   6786,   6589,
    6392,   6195,   5997,   5799,
    5601,   5403,   5205,   5006,
    4807,   4608,   4409,   4210,
    4011,   3811,   3611,   3411,
    3211,   3011,   2811,   2610,
    2410,   2209,   2009,   1808,
    1607,   1406,   1206,   1005,
     804,    603,    402,    201,
       0,   -201,   -402,   -603,
    -804,  -1005,  -1206,  -1406,
   -1607,  -1808,  -2009,  -2209,
   -2410,  -2610,  -2811,  -3011,
   -3211,  -3411,  -3611,  -3811,
   -4011,  -4210,  -4409,  -4608,
   -4807,  -5006,  -5205,  -5403,
   -5601,  -5799,  -5997,  -6195,
   -6392,  -6589,  -6786,  -6982,
   -7179,  -7375,  -7571,  -7766,
   -7961,  -8156,  -8351,  -8545,
   -8739,  -8932,  -9126,  -9319,
   -9511,  -9703,  -9895, -10087,
  -10278, -10469, -10659, -10849,
  -11038, -11227, -11416, -11604,
  -11792, -11980, -12166, -12353,
  -12539, -12724, -12909, -13094,
  -13278, -13462, -13645, -13827,
  -14009, -14191, -14372, -14552,
  -14732, -14911, -15090, -15268,
  -15446, -15623, -15799, -15975,
  -16150, -16325, -16499, -16672,
  -16845, -17017, -17189, -17360,
  -17530, -17699, -17868, -18036,
  -18204, -18371, -18537, -18702,
  -18867, -19031, -19194, -19357,
  -19519, -19680, -19840, -20000,
  -20159, -20317, -20474, -20631,
  -20787, -20942, -21096, -21249,
  -21402, -21554, -21705, -21855,
  -22004, -22153, -22301, -22448,
  -22594, -22739, -22883, -23027,
  -23169, -23311, -23452, -23592,
  -23731, -23869, -24006, -24143,
  -24278, -24413, -24546, -24679,
  -24811, -24942, -25072, -25201,
  -25329, -25456, -25582, -25707,
  -25831, -25954, -26077, -26198,
  -26318, -26437, -26556, -26673,
  -26789, -26905, -27019, -27132,
  -27244, -27355, -27466, -27575,
  -27683, -27790, -27896, -28001,
  -28105, -28208, -28309, -28410,
  -28510, -28608, -28706, -28802,
  -28897, -28992, -29085, -29177,
  -29268, -29358, -29446, -29534,
  -29621, -29706, -29790, -29873,
  -29955, -30036, -30116, -30195,
  -30272, -30349, -30424, -30498,
  -30571, -30643, -30713, -30783,
  -30851, -30918, -30984, -31049,
  -31113, -31175, -31236, -31297,
  -31356, -31413, -31470, -31525,
  -31580, -31633, -31684, -31735,
  -31785, -31833, -31880, -31926,
  -31970, -32014, -32056, -32097,
  -32137, -32176, -32213, -32249,
  -32284, -32318, -32350, -32382,
  -32412, -32441, -32468, -32495,
  -32520, -32544, -32567, -32588,
  -32609, -32628, -32646, -32662,
  -32678, -32692, -32705, -32717,
  -32727, -32736, -32744, -32751,
  -32757, -32761, -32764, -32766,
  -32767, -32766, -32764, -32761,
  -32757, -32751, -32744, -32736,
  -32727, -32717, -32705, -32692,
  -32678, -32662, -32646, -32628,
  -32609, -32588, -32567, -32544,
  -32520, -32495, -32468, -32441,
  -32412, -32382, -32350, -32318,
  -32284, -32249, -32213, -32176,
  -32137, -32097, -32056, -32014,
  -31970, -31926, -31880, -31833,
  -31785, -31735, -31684, -31633,
  -31580, -31525, -31470, -31413,
  -31356, -31297, -31236, -31175,
  -31113, -31049, -30984, -30918,
  -30851, -30783, -30713, -30643,
  -30571, -30498, -30424, -30349,
  -30272, -30195, -30116, -30036,
  -29955, -29873, -29790, -29706,
  -29621, -29534, -29446, -29358,
  -29268, -29177, -29085, -28992,
  -28897, -28802, -28706, -28608,
  -28510, -28410, -28309, -28208,
  -28105, -28001, -27896, -27790,
  -27683, -27575, -27466, -27355,
  -27244, -27132, -27019, -26905,
  -26789, -26673, -26556, -26437,
  -26318, -26198, -26077, -25954,
  -25831, -25707, -25582, -25456,
  -25329, -25201, -25072, -24942,
  -24811, -24679, -24546, -24413,
  -24278, -24143, -24006, -23869,
  -23731, -23592, -23452, -23311,
  -23169, -23027, -22883, -22739,
  -22594, -22448, -22301, -22153,
  -22004, -21855, -21705, -21554,
  -21402, -21249, -21096, -20942,
  -20787, -20631, -20474, -20317,
  -20159, -20000, -19840, -19680,
  -19519, -19357, -19194, -19031,
  -18867, -18702, -18537, -18371,
  -18204, -18036, -17868, -17699,
  -17530, -17360, -17189, -17017,
  -16845, -16672, -16499, -16325,
  -16150, -15975, -15799, -15623,
  -15446, -15268, -15090, -14911,
  -14732, -14552, -14372, -14191,
  -14009, -13827, -13645, -13462,
  -13278, -13094, -12909, -12724,
  -12539, -12353, -12166, -11980,
  -11792, -11604, -11416, -11227,
  -11038, -10849, -10659, -10469,
  -10278, -10087,  -9895,  -9703,
   -9511,  -9319,  -9126,  -8932,
   -8739,  -8545,  -8351,  -8156,
   -7961,  -7766,  -7571,  -7375,
   -7179,  -6982,  -6786,  -6589,
   -6392,  -6195,  -5997,  -5799,
   -5601,  -5403,  -5205,  -5006,
   -4807,  -4608,  -4409,  -4210,
   -4011,  -3811,  -3611,  -3411,
   -3211,  -3011,  -2811,  -2610,
   -2410,  -2209,  -2009,  -1808,
   -1607,  -1406,  -1206,  -1005,
    -804,   -603,   -402,   -201,
       0
};

const int16_t env_overdrive[] = {
    -32768, -32764, -32755, -32740,
    -32719, -32692, -32660, -32622,
    -32578, -32528, -32473, -32412,
    -32345, -32273, -32196, -32113,
    -32025, -31932, -31833, -31730,
    -31621, -31507, -31388, -31264,
    -31135, -31001, -30862, -30718,
    -30570, -30417, -30259, -30097,
    -29930, -29758, -29583, -29402,
    -29217, -29028, -28835, -28637,
    -28435, -28229, -28019, -27805,
    -27587, -27365, -27139, -26909,
    -26675, -26438, -26196, -25951,
    -25703, -25451, -25195, -24936,
    -24674, -24408, -24138, -23866,
    -23590, -23311, -23029, -22743,
    -22455, -22164, -21869, -21572,
    -21272, -20969, -20663, -20355,
    -20044, -19730, -19414, -19095,
    -18773, -18449, -18123, -17795,
    -17464, -17131, -16795, -16458,
    -16118, -15777, -15433, -15087,
    -14740, -14390, -14039, -13686,
    -13331, -12975, -12617, -12257,
    -11896, -11533, -11169, -10804,
    -10437, -10068, -9699, -9328,
    -8957, -8584, -8210, -7835,
    -7459, -7082, -6704, -6325,
    -5946, -5566, -5185, -4803,
    -4421, -4039, -3655, -3272,
    -2888, -2504, -2119, -1734,
    -1349, -964, -578, -193,
    193, 578, 964, 1349,
    1734, 2119, 2504, 2888,
    3272, 3655, 4039, 4421,
    4803, 5185, 5566, 5946,
    6325, 6704, 7082, 7459,
    7835, 8210, 8584, 8957,
    9328, 9699, 10068, 10437,
    10804, 11169, 11533, 11896,
    12257, 12617, 12975, 13331,
    13686, 14039, 14390, 14740,
    15087, 15433, 15777, 16118,
    16458, 16795, 17131, 17464,
    17795, 18123, 18449, 18773,
    19095, 19414, 19730, 20044,
    20355, 20663, 20969, 21272,
    21572, 21869, 22164, 22455,
    22743, 23029, 23311, 23590,
    23866, 24138, 24408, 24674,
    24936, 25195, 25451, 25703,
    25951, 26196, 26438, 26675,
    26909, 27139, 27365, 27587,
    27805, 28019, 28229, 28435,
    28637, 28835, 29028, 29217,
    29402, 29583, 29758, 29930,
    30097, 30259, 30417, 30570,
    30718, 30862, 31001, 31135,
    31264, 31388, 31507, 31621,
    31730, 31833, 31932, 32025,
    32113, 32196, 32273, 32345,
    32412, 32473, 32528, 32578,
    32622, 32660, 32692, 32719,
    32740, 32755, 32762, 32765,
    32767
};

const int16_t beta_inv[] = {
    60,	72,	82,	107, 161,
    70,	72,	83,	109, 165,
    70,	73,	84,	111, 169,
    70,	73,	85,	113, 174,
    70,	73,	86,	115, 179,
    70,	74,	87,	117, 184,
    70,	74,	88,	119, 190,
    70,	75,	89,	121, 196,
    70,	75,	90,	124, 202,
    70,	75,	91,	126, 209,
    70,	76,	92,	129, 216,
    70,	76,	94,	131, 224,
    71,	77,	95,	134, 233,
    71,	78,	96,	137, 243,
    71,	78,	98,	140, 254,
    71,	79,	99,	143, 266,
    71	,79	,101,	146, 281,
    71	,80	,102,	150, 299,
    72	,81	,104,	153, 322,
    72	,82	,105,	157, 356
};